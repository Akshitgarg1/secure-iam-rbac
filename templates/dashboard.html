<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard | Secure IAM</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>

<div class="navbar">
    <div>
        Secure IAM Dashboard  
        <span>| Role: {{ role }}</span>
    </div>
    <a href="/logout">Logout</a>
</div>

<div class="container">
    <h2>Welcome</h2>
    <p>
        Access is controlled using <strong>Role-Based Access Control (RBAC)</strong>
        combined with <strong>IP-Aware Network Security</strong>.
    </p>
     
    <!-- Login Info -->
    <div style="margin-top:20px; margin-bottom:30px;">
        <p>
            <strong>Last Login IP:</strong>
            {{ last_login_ip or "N/A" }}
            <br>
            <strong>Last Login Time:</strong>
            {{ last_login_time.strftime("%d %b %Y, %I:%M %p") if last_login_time else "First login" }}
        </p>
    </div>

    <div class="cards">

        <!-- Admin Panel (Visible to all, restricted by RBAC) -->
        <div class="card admin">
            <h3>Admin Panel</h3>

            {% if role == 'Admin' %}
                <p>
                    Administrative access protected using
                    RBAC and IP-based policies.
                </p>
                <a href="/audit-logs" style="
                    display:inline-block;
                    background:#334155;
                    color:white;
                    padding:10px 18px;
                    border-radius:8px;
                    font-size:25px;
                    text-decoration:none;
                ">
                    View Audit Logs
                </a>
            {% else %}
                <p style="color:#dc2626;">
                    Restricted: Admin privileges required
                </p>
                <a href="/audit-logs" style="
                    display:inline-block;
                    background:#9ca3af;
                    color:white;
                    padding:10px 18px;
                    border-radius:8px;
                    font-size:25px;
                    text-decoration:none;
                    cursor:not-allowed;
                ">
                    View Audit Logs
                </a>
            {% endif %}
        </div>

        <!-- Employee Panel -->
        {% if role == 'Employee' or role == 'Admin' %}
        <div class="card employee">
            <h3>Employee Panel</h3>
            <p>
                Employee-level access granted based on
                RBAC authorization rules.
            </p>
            <a href="/employee">Open Employee Panel</a>
        </div>
        {% endif %}

    </div>

    <div class="note">
        ðŸ”’ All access attempts are monitored and logged for security auditing.
    </div>
</div>

</body>
</html>
